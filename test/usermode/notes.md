This example was taken from u-root project.